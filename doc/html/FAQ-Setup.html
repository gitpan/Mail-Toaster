<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Mail::Toaster::Setup FAQ</title>
<link rev="made" href="mailto:root@hampsten.nonet" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#what_features_does_the_toaster_support">What features does the Toaster support?</a></li>
	<li><a href="#what_programs_will_be_installed">What programs will be installed?</a></li>
	<li><a href="#what_are_the_mail_retrieval_options">What are the mail retrieval options?</a></li>
	<li><a href="#how_do_i_manage_mail_options_for_a_domain">How do I manage mail options for a domain?</a></li>
	<li><a href="#where_do_i_find_the_maildomain_script">Where do I find the maildomain script?</a></li>
	<li><a href="#how_do_i_convert_multilog_date_stamps_to_human_readable_date_stamps">How do I convert Multilog date stamps to human readable date stamps?</a></li>
	<li><a href="#how_do_i_find_statistics_about_my_mail_queue_">How do I find statistics about my mail queue:</a></li>
	<li><a href="#how_do_i_enable_the_sqwebmail_calendar">How do I enable the sqwebmail calendar?</a></li>
	<li><a href="#when_will_you_add_support_for_my_platform">When will you add support for my platform?</a></li>
	<li><a href="#how_do_i_block_connections_from_servers_with_no_reverse_dns">How do I block connections from servers with no reverse DNS?</a></li>
	<li><a href="#how_do_i_use_spamassassin___clamav">How do I use SpamAssassin &amp; ClamAV?</a></li>
	<li><a href="#whats_the_best_way_to_view_expire_messages_from_the_queue">Whats the best way to view/expire messages from the queue?</a></li>
	<li><a href="#why_are_imap_connections_getting_reset">Why are IMAP connections getting reset?</a></li>
	<li><a href="#how_do_i_delete_old_messages_in_the_spam_folders">How do I delete old messages in the Spam folders?</a></li>
	<li><a href="#where_is_the_ucspitcp_patch">Where is the UCSPI-TCP patch?</a></li>
	<li><a href="#how_can_i_modify_the_sqwebmail_interface">How can I modify the Sqwebmail interface?</a></li>
	<li><a href="#how_can_i_modify_the_qmailadmin_interface">How can I modify the Qmailadmin interface?</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="what_features_does_the_toaster_support">What features does the Toaster support?</a></h1>
<pre>
  SMTP Mail Server (+SMTP-AUTH, TLS (SSL), tarpitting)
  Virtual Domain Hosting
  Virtual Domain Users
  AutoResponder
  Mailing List (Ezmlm)
  Web Based E-Mail (SSL, spell check, LDAP lookup)
  Web Based Virtual Domain Administration
  Spam Blocking (SpamAssassin, Qmail-Scanner)
  SMTP roaming via SMTP-AUTH, POP-AUTH, &amp; IMAP-AUTH
  POP3 (+SSL) 
  IMAP (+SSL)</pre>
<p>
</p>
<hr />
<h1><a name="what_programs_will_be_installed">What programs will be installed?</a></h1>
<pre>
  Qmail 1.03  : Secure, wicked fast, and reliable MTA
  MySQL       : Database engine
  ucspi-tcp   : Inetd replacement
  daemontools : Useful tools for managing daemons
  qmailanalog : Tools for parsing qmail logs 
  ezmlm-idx   : Mailing list management
  Apache + mod_php &amp; mod_perl: Secure HTTP server
  OpenLDAP    : LDAP client &amp; server
  vpopmail    : Virtual Domain module
  autorespond : Auto Responder
  gdbm         : Database routines
  ispell      : Spell checking for web mail
  qmailadmin  : Web Control Panel Interface
  sqwebmail   : Web based email
  courier-IMAP: IMAP &amp; POP3 servers</pre>
<p>
</p>
<hr />
<h1><a name="what_are_the_mail_retrieval_options">What are the mail retrieval options?</a></h1>
<pre>
  pop3://mail.example.com
  imap://mail.example.com
  pop3s://mail.example.com
  imaps://mail.example.com</pre>
<pre>
  <a href="http://mail.example.com/cgi-bin/sqwebmail">http://mail.example.com/cgi-bin/sqwebmail</a>
  https://mail.example.com/cgi-bin/sqwebmail</pre>
<pre>
  <a href="http://squirrelmail.example.com/">http://squirrelmail.example.com/</a>
  https://squirrelmail.example.com/</pre>
<p>
</p>
<hr />
<h1><a name="how_do_i_manage_mail_options_for_a_domain">How do I manage mail options for a domain?</a></h1>
<p>Point a web broswer at <a href="https://mail.example.com/cgi-bin/qmailadmin">https://mail.example.com/cgi-bin/qmailadmin</a></p>
<p>
</p>
<hr />
<h1><a name="where_do_i_find_the_maildomain_script">Where do I find the maildomain script?</a></h1>
<p>maildomain perl script - Front end to nearly everything you can do with the vpopmail programs. <a href="http://localhost.tnpi.biz/internet/mail/toaster/maildomain/maildomain.pl">http://localhost.tnpi.biz/internet/mail/toaster/maildomain/maildomain.pl</a></p>
<p>
</p>
<hr />
<h1><a name="how_do_i_convert_multilog_date_stamps_to_human_readable_date_stamps">How do I convert Multilog date stamps to human readable date stamps?</a></h1>
<pre>
  tai64nlocal &lt; logfile &gt; qmaillog.tmp</pre>
<p>
</p>
<hr />
<h1><a name="how_do_i_find_statistics_about_my_mail_queue_">How do I find statistics about my mail queue:</a></h1>
<pre>
  1. qmail queue | more</pre>
<pre>
  2. Install isoqlog</pre>
<pre>
  3. Manually feed qmail-send output through matchup and pipe
    the results through a processor (all one one line):</pre>
<pre>
     /usr/local/qmailanalog/bin/matchup &lt; 
     /var/log/mail/send/current | 
     /usr/local/qmailanalog/bin/z*</pre>
<pre>
    where z* is one of the following:</pre>
<pre>
    zddist, zdeferrals, zfailures, zoverall, zrecipients, 
    zrhosts, zrxdelay, zsenders, zsuccesses, zsuids</pre>
<p>
</p>
<hr />
<h1><a name="how_do_i_enable_the_sqwebmail_calendar">How do I enable the sqwebmail calendar?</a></h1>
<p>echo ``local'' &amp;gt; /usr/local/share/sqwebmail/calendarmode</p>
<p>
</p>
<hr />
<h1><a name="when_will_you_add_support_for_my_platform">When will you add support for my platform?</a></h1>
<p>I have already begun making all my scripts more extensible in anticipation of using them on platforms other than FreeBSD where they were developed. My next ``supported'' OS will be Mac OS X and then probably Linux. If you prefer Linux, check out Bill Shupp's toaster pages. Here's a couple URLs for you: <a href="http://www.shupp.org/toaster/">http://www.shupp.org/toaster/</a> and <a href="http://qmailtoaster.clikka.com/.">http://qmailtoaster.clikka.com/.</a></p>
<p>
</p>
<hr />
<h1><a name="how_do_i_block_connections_from_servers_with_no_reverse_dns">How do I block connections from servers with no reverse DNS?</a></h1>
<p>Contents of ~vpopmail/etc/tcp.smtp (fix wrapped lines):</p>
<pre>
 127.:allow,RELAYCLIENT=&quot;&quot;
 209.218.8.2:allow
 =:allow
 :allow,RBLSMTPD=&quot;Blocked - Reverse DNS queries for 
   your IP fail. You cannot send me mail.&quot;
 #:allow,RBLSMTPD=&quot;-Blocked - Reverse DNS queries for 
   your IP fail. You cannot send me mail.&quot;</pre>
<pre>
 line 1. Obvious, allows localhost to relay.
 line 2. Allows traffic from the inter7 email list
 line 3. Matches any mail message with reverse dns.</pre>
<p>line 4. Matches what's left (no reverse DNS). By setting the RBLSMTPD environment variable, we actually get to pass a message back to the mail server we're blocking telling them why. That gives them a chance to fix it before the messages bounces.</p>
<p>They'll get a message like this in their mail logs:</p>
<p>Mar 27 08:40:43 seattle qmail: 1048783243.397888 info msg 6469: bytes 258 from qp 13226 uid 0
Mar 27 08:40:43 seattle qmail: 1048783243.438981 starting delivery 533: msg 6469 to remote <a href="mailto:matt@simerson.net">matt@simerson.net</a>
Mar 27 08:40:43 seattle qmail: 1048783243.979048 delivery 533: deferral: 207.89.154.94_does_not_like_recipient./ Remote_host_said:_451_Blocked_ Reverse_DNS_queries_for_your_IP_failed. You_cannot_send_me_mail. Giving_up_on_207.89.154.94./</p>
<p>line 5. If you want to be a little more aggressive about it, use the 5th line instead of the fourth. Notice the '-' character in there. That tells rblsmtpd to return a permanent error (ie, don't try again!)</p>
<p>Mar 27 08:42:40 seattle qmail: 1048783360.776812 info msg 6475: bytes 250 from qp 13464 uid 0
Mar 27 08:42:40 seattle qmail: 1048783360.805534 starting delivery 534: msg 6475 to remote <a href="mailto:matt@simerson.net">matt@simerson.net</a>
Mar 27 08:42:41 seattle qmail: 1048783361.259737 delivery 534: failure: 207.89.154.94_does_not_like_recipient. Remote_host_said:_553_Blocked_-_Reverse_DNS_queries_for_your_IP_fail. You_cannot_send_me_mail. Giving_up_on_207.89.154.94./
Mar 27 08:42:41 seattle qmail: 1048783361.269637 bounce msg 6475 qp 13467
Mar 27 08:42:41 seattle qmail: 1048783361.270564 end msg 6475</p>
<p>Notice that in the second case, the message bounces immediately. It's your mail server, you have to decide what policy you think is best. Bouncing messages seems to get more attention, and gets it faster than deferring connections.</p>
<p>That's all there is to it. Of course, that assumes you are running rblsmtpd as part of your smtp invocation.</p>
<p>
</p>
<hr />
<h1><a name="how_do_i_use_spamassassin___clamav">How do I use SpamAssassin &amp; ClamAV?</a></h1>
<p>See the Filtering section at <a href="http://www.tnpi.biz/internet/mail/toaster/filter.shtml">http://www.tnpi.biz/internet/mail/toaster/filter.shtml</a></p>
<p>
</p>
<hr />
<h1><a name="whats_the_best_way_to_view_expire_messages_from_the_queue">Whats the best way to view/expire messages from the queue?</a></h1>
<p>Use my qqtool utility: <a href="http://www.tnpi.biz/internet/mail/qqtool/">http://www.tnpi.biz/internet/mail/qqtool/</a></p>
<p>
</p>
<hr />
<h1><a name="why_are_imap_connections_getting_reset">Why are IMAP connections getting reset?</a></h1>
<p>See this post to the mailing list for a possible explanation: <a href="http://matt.simerson.net/cgi-bin/ezmlm.cgi?mss:2006:pnonldigcpgkfpehlcgo">http://matt.simerson.net/cgi-bin/ezmlm.cgi?mss:2006:pnonldigcpgkfpehlcgo</a></p>
<p>
</p>
<hr />
<h1><a name="how_do_i_delete_old_messages_in_the_spam_folders">How do I delete old messages in the Spam folders?</a></h1>
<p>find /usr/local/vpopmail/domains/*/*/Maildir/.SPAM/cur -type f -mtime +30 -exec rm -f {} \;</p>
<p>deletes files older than 30d</p>
<p>no guarantee, that just came off from the top of my head :) haven't tested, but worth the try :D regards, Andryan.</p>
<p>
</p>
<hr />
<h1><a name="where_is_the_ucspitcp_patch">Where is the UCSPI-TCP patch?</a></h1>
<p><a href="http://www.tnpi.biz/internet/mail/toaster/patches/tcpserver-mysql.shtml">http://www.tnpi.biz/internet/mail/toaster/patches/tcpserver-mysql.shtml</a></p>
<p>The patch adds MySQL query support to tcpserver. The patch will allow tcpserver to query a Mysql server for each new connection and set RELAYCLIENT based on the presence of the remote IP in the table. This is a very useful and popular patch.</p>
<p>
</p>
<hr />
<h1><a name="how_can_i_modify_the_sqwebmail_interface">How can I modify the Sqwebmail interface?</a></h1>
<p>The html temples live in /usr/local/share/sqwebmail/html/</p>
<p>
</p>
<hr />
<h1><a name="how_can_i_modify_the_qmailadmin_interface">How can I modify the Qmailadmin interface?</a></h1>
<p>The html templates live in /usr/local/share/qmailadmin/html/</p>

</body>

</html>
