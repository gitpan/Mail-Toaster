<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Mail::Toaster Install</title>
<link rev="made" href="mailto:root@hampsten.nonet" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#step_1__make_perl_happy_">Step 1: Make Perl happy.</a></li>
	<li><a href="#step_2__install_matt__bundle_">Step 2: Install MATT::Bundle.</a></li>
	<li><a href="#step_3__install_mail__toaster">Step 3: Install Mail::Toaster</a></li>
	<li><a href="#step_4__edit_config_files">Step 4: Edit config files</a></li>
	<li><a href="#step_5__start_building_the_toaster_">Step 5: Start building the toaster!</a></li>
	<li><a href="#step_7__install_qmail">Step 7: Install Qmail</a></li>
	<li><a href="#step_8__install_web_pop3_imap_servers">Step 8: Install Web/POP3/IMAP servers</a></li>
	<li><a href="#step_9__configure_courierimap">Step 9: Configure Courier-IMAP</a></li>
	<li><a href="#step_10__set_up_mail_filtering_and_logging">Step 10: Set up mail filtering and logging</a></li>
	<li><a href="#step_11__add_cron_entries">Step 11: Add cron entries</a></li>
	<li><a href="#step_12__continue_with_configuration_">Step 12: Continue with Configuration.</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="step_1__make_perl_happy_">Step 1: Make Perl happy.</a></h1>
<p>Certain features (like spam filtering) require perl 5.6.1 or higher to function fully. If perl -v reflects anything smaller than 5.6.1, do either of the following:</p>
<pre>
  pkg_add -r perl  (on FreeBSD 5+)</pre>
<pre>
      or</pre>
<pre>
  cd /usr/ports/lang/perl5;
  make install clean;
  rehash; use.perl port;</pre>
<p>You need Perl's CPAN working for installing perl modules so make sure it's configured. If the following command doesn't give you a prompt, then you'll be prompted to configure.</p>
<pre>
  perl -MCPAN -e shell
  exit</pre>
<p>
</p>
<hr />
<h1><a name="step_2__install_matt__bundle_">Step 2: Install MATT::Bundle.</a></h1>
<p><a href="http://www.tnpi.biz/computing/perl/MATT-Bundle/MATT-Bundle.tar.gz">http://www.tnpi.biz/computing/perl/MATT-Bundle/MATT-Bundle.tar.gz</a></p>
<pre>
   perl Makefile.PL
   make install</pre>
<p>There is a fair amount of documenation on MATT::Bundle which can be read via ``perldoc MATT::Bundle''. That also applies for subsequent MATT::* targets. The docs are also available at <a href="http://www.tnpi.biz/computing/perl/MATT-Bundle/.">http://www.tnpi.biz/computing/perl/MATT-Bundle/.</a></p>
<p>
</p>
<hr />
<h1><a name="step_3__install_mail__toaster">Step 3: Install Mail::Toaster</a></h1>
<p><a href="http://www.tnpi.biz/internet/mail/toaster/Mail-Toaster.tar.gz">http://www.tnpi.biz/internet/mail/toaster/Mail-Toaster.tar.gz</a></p>
<pre>
   perl Makefile.PL
   make install
   make newconf (overwrites installed .conf files)
   make cgi</pre>
<p>or</p>
<pre>
   perl -e 'use MATT::Utility; InstallMailToaster';</pre>
<p>Documentation for the modules being called by toaster_setup.pl, toaster_watcher.pl, maillogs, and index.cgi are all installed in Perl's pod format (perldoc Mail::Toaster, perldoc Mail::Toaster::CGI, etc) as well as being available online at <a href="http://www.tnpi.biz/internet/mail/toaster/.">http://www.tnpi.biz/internet/mail/toaster/.</a></p>
<p>
</p>
<hr />
<h1><a name="step_4__edit_config_files">Step 4: Edit config files</a></h1>
<pre>
   vi /usr/local/etc/toaster.conf
   vi /usr/local/etc/toaster-watcher.conf</pre>
<p>Edit to suit your preferences.</p>
<p>
</p>
<hr />
<h1><a name="step_5__start_building_the_toaster_">Step 5: Start building the toaster!</a></h1>
<pre>
   rehash
   toaster_setup.pl -s pre
   toaster_setup.pl -s ports
   toaster_setup.pl -s mysql
   toaster_setup.pl -s [ apache2 | apache ]
   toaster_setup.pl -s apachessl (create ssl certs)
   toaster_setup.pl -s phpmyadmin (optional)
   toaster_setup.pl -s ucspi
   toaster_setup.pl -s ezmlm 
   toaster_setup.pl -s vpopmail
   toaster_setup.pl -s qmailadmin</pre>
<p>If toaster_setup.pl has any problems running, fix what it complains about and then run it again with the same parameter. It will resume and finish that section.</p>
<p>If you want something installed ``your'' way, install it first. Toaster_setup.pl will detect it (assuming it's registered in the package database) and skip that portion of the install.</p>
<p>When you install Apache, it'll also install PHP which is required by squirrelmail and QSS. Make sure to select the following modules: GD, MYSQL, OPENSSL, &amp; SNMP. Other modules are optional, I recommend selecting those I've listed in addition to the ``defaults''.</p>
<p>
</p>
<hr />
<h1><a name="step_7__install_qmail">Step 7: Install Qmail</a></h1>
<pre>
   toaster_setup.pl -s qmail</pre>
<p>patch info: <a href="http://www.tnpi.biz/internet/mail/toaster/patches/">http://www.tnpi.biz/internet/mail/toaster/patches/</a></p>
<p>
</p>
<hr />
<h1><a name="step_8__install_web_pop3_imap_servers">Step 8: Install Web/POP3/IMAP servers</a></h1>
<pre>
   toaster_setup.pl -s courier
   toaster_setup.pl -s sqwebmail
   toaster_setup.pl -s squirrelmail</pre>
<p>
</p>
<hr />
<h1><a name="step_9__configure_courierimap">Step 9: Configure Courier-IMAP</a></h1>
<pre>
   cd /usr/local/etc/courier-imap
   vi pop3d.cnf imapd.cnf quotawarnmsg</pre>
<pre>
   cd /usr/local/share/courier-imap
   ./mkimapdcert; ./mkpop3dcert</pre>
<p>
</p>
<hr />
<h1><a name="step_10__set_up_mail_filtering_and_logging">Step 10: Set up mail filtering and logging</a></h1>
<pre>
   toaster_setup.pl -s filter
   toaster_setup.pl -s supervise
   toaster_setup.pl -s maillogs
   toaster_setup.pl -s rrdutil (optional)</pre>
<p>
</p>
<hr />
<h1><a name="step_11__add_cron_entries">Step 11: Add cron entries</a></h1>
<p>Run all these commands from the command line and verify their proper functionality (no complaints or errors) BEFORE adding to cron.</p>
<pre>
 crontab -u root -e</pre>
<pre>
  9-59/10 * * * * /usr/local/vpopmail/bin/clearopensmtp
  40  * * * *  /usr/local/share/sqwebmail/cleancache.pl
  */5 * * * * /usr/local/sbin/toaster-watcher.pl
  */5 * * * * /usr/local/www/cgi-bin/rrdutil.cgi -a update</pre>
<p>
</p>
<hr />
<h1><a name="step_12__continue_with_configuration_">Step 12: Continue with Configuration.</a></h1>
<p>Visit this URL: <a href="http://www.tnpi.biz/internet/mail/toaster/config.shtml">http://www.tnpi.biz/internet/mail/toaster/config.shtml</a> Skipping this step is guaranteed to make you less than pleased with your toaster.</p>
<p>See <a href="http://mail.cadillac.net/">http://mail.cadillac.net/</a> for an example of index.cgi.</p>

</body>

</html>
