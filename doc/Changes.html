<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Mail Toaster Changes</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:matt@intellimac.local" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->
<!--

<ul>

	<li><a href="#mail_toaster_changes">Mail Toaster Changes</a></li>
	<ul>

		<li><a href="#5_03rc1__oct_15__2006">5.03rc1 - Oct 15, 2006</a></li>
		<li><a href="#5_02__2006_10_11">5.02 - 2006.10.11</a></li>
		<li><a href="#5_02b__2006_09_28">5.02b - 2006.09.28</a></li>
		<li><a href="#5_01__2006_09_22">5.01 - 2006.09.22</a></li>
		<li><a href="#5_00__2006_09_18">5.00 - 2006.09.18</a></li>
	</ul>

</ul>
-->
<!-- INDEX END -->

<p>
</p>
<h1><a name="mail_toaster_changes">Mail Toaster Changes</a></h1>
<p>
</p>
<h2><a name="5_03rc1__oct_15__2006">5.03rc1 - Oct 15, 2006</a></h2>
<dl>
<dt><strong><a name="item_packaging_updates">Packaging Updates</a></strong>

<dd>
<p>Moved Params::Validated into inc directory (prevent CPAN from presumign I provide it), moved Changes back into doc/Changes.pod, added include lib ``inc'' into all test files (forgot that with 5.02 release).</p>
</dd>
<dd>
<p>Better pod descriptions for FreeBSD.pm, Mysql.pm, Apache.pm, Ezmlm.pm, Darwin.pm, DNS.pm, Provision.pm, Setup.pm, Passwd.pm, Perl.pm, and Toaster.pm.</p>
</dd>
</li>
</dl>
<pre>
 toaster-watcher.conf
   added install_roundcube option</pre>
<pre>
 Darwin.pm
   updated $utility calls with MT 5 syntax updates
   udpated test file to use Test::More</pre>
<pre>
 t/Utility.t
    only attempt to chown_system if we are root, don't run get_my_ips on 
    netbsd (until I figure out why it doesn't work</pre>
<pre>
 Changes
   added file to distribution</pre>
<pre>
 bin/toaster_setup.pl
   added RT URL to bug section for reporting</pre>
<pre>
 bin/sysadmin
   updated for MT 5 syntax</pre>
<pre>
 Passwd.pm 
    mt 5 syntax updates, add in warnings for failures</pre>
<pre>
 Qmail.pm
   formatting cleanups, and added a few missing debug=&gt;0 settings.</pre>
<pre>
 Provision.pm
    mt 5 updates and rewrite. If values are missing and we are interactive,
       prompt for the missing values.
    pass debug and $conf variables in the $provision object (accomplish 
       the same result with less code)</pre>
<pre>
 Utility.pm
   answer sub now returns $default value (instead of 0) if not interactive
   yes_or_no supports q shortcut for question argument</pre>
<p>
</p>
<h2><a name="5_02__2006_10_11">5.02 - 2006.10.11</a></h2>
<dl>
<dt><strong><a name="item_toaster_2dwatcher_2econf">toaster-watcher.conf</a></strong>

<dd>
<p>added options install_ezmlm_mysql, vpopmail_mysql_repl_master_port, vpopmail_mysql_repl_slave_port</p>
</dd>
</li>
<dt><strong><a name="item_t_2ftoaster_2epm">t/Toaster.pm</a></strong>

<dd>
<p>get_dir_files tests the file size to see if any domains are added yet (more reliable test)</p>
</dd>
</li>
<dt><strong><a name="item_freebsd_2epm">FreeBSD.pm</a></strong>

<dd>
<pre>
 fixed a recursion bug in ports_update (portsnap)
 install a default portsnap.conf if missing
 FreeBSD version detection wasn't working</pre>
</dd>
<dt><strong><a name="item_apache_2epm">Apache.pm</a></strong>

<dd>
<pre>
 added security options to mail-toaster.conf to harden Apache
 added PHP AddType declarations
 added directory block for phpmyadmin
 only add phpmyadmin block if selected in toaster-watcher.conf</pre>
</dd>
<dt><strong><a name="item_setup_2epm">Setup.pm</a></strong>

<dd>
<p>ezmlm mysql support now depends on install_ezmlm_mysql setting instead of install_mysql.</p>
</dd>
<dd>
<p>added support for vpopmail mysql database port number (thanks Erik!)</p>
</dd>
<dd>
<p>vpopmail_mysql_database setting is now honored.</p>
</dd>
<dd>
<p>busted huge vpopmail sub into a dozen smaller ones for easier maintenance.</p>
</dd>
<dd>
<p>heredoc's used in creation of tcp.smtp used  ' and needed ``</p>
</dd>
<dd>
<p>logic for NO_SENDMAIL test was inverted causing it to be added to /etc/make.conf more than once.</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="5_02b__2006_09_28">5.02b - 2006.09.28</a></h2>
<dl>
<dt><strong><a name="item_index_2ecgi">index.cgi</a></strong>

<dd>
<p>defined debug (caused it to not work)</p>
</dd>
</li>
<dt><strong>Apache.pm</strong>

<dd>
<p>test for toaster_apache_vhost</p>
</dd>
<dd>
<p>add alias for rrdutil, v-webmail, and roundcube to apache's vhost config <code>file(mail-toaster.conf)</code></p>
</dd>
</li>
<dt><strong><a name="item_ezmlm_2epm">Ezmlm.pm</a></strong>

<dd>
<pre>
 define any missing cgi params to suppress errors messages
 filled in pod description</pre>
</dd>
<dt><strong><a name="item_freebsd_2epm__2d_detection_of_portsdb_wasn_27t_wor">FreeBSD.pm - detection of portsdb wasn't working</a></strong>

<dd>
<p>supress notification of new toaster-watcher.conf install if its missing</p>
</dd>
</li>
<dt><strong><a name="item_logs_2epm__2d_prettied_up_the_yesterday_report_a_l">Logs.pm - prettied up the yesterday report a little bit.</a></strong>

<dd>
<pre>
 added checks to prevent warnings when logs are empty
 log archiving was failing (invalid test)</pre>
</dd>
<dt><strong><a name="item_perl_2epm">Perl.pm</a></strong>

<dd>
<pre>
 added pod doc for has_module</pre>
</dd>
<dt><strong>Setup.pm</strong>

<dd>
<pre>
 phpmyadmin_install was not passing $conf</pre>
</dd>
<dt><strong><a name="item_utility_2epm">Utility.pm</a></strong>

<dd>
<p>Fixed a bug in mailtoaster sub that prevented it from finding the tw.conf file</p>
</dd>
<dd>
<p>added _progress_??? subs for providing status messages on the CLI</p>
</dd>
<dd>
<p>added pod documentation for several subs that had none</p>
</dd>
</li>
</dl>
<p>
</p>
<h2><a name="5_01__2006_09_22">5.01 - 2006.09.22</a></h2>
<pre>
 added help-&gt;vpopmail option to web interface
 added setup -s allspam option (enabled mail filtering for all users)
 default ports update mechanism is now portsnap
 removed dependency on Net::DNS (using dig)</pre>
<p>commented out v-webmail, roundcube, vqadmin, and ezmlm menu options. Those items are not installed by Mail::Toaster (yet).</p>
<p>added code in -s all target to refresh the $conf hashref after -s config target is run</p>
<p>moved $conf into the Setup.pm object. Significantly reduced the amount of passing $conf around from sub to sub.</p>
<p>added options and explicit port install options for gnupg and Archive::Tar to surpress dialog boxes.</p>
<p>timer was not working in yes_or_no due to typo in param validation block</p>
<p>disabled ezmlm and vqadmin in webmail. Activate them by removing the comments in mt-top.html</p>
<p>default cvsup_supfile_sources settings is now cvsup-sources (was cvsup-stable)</p>
<p>tweaks so ``make test'' runs with fewer warnings</p>
<p>toaster_setup -s sources now auto-builds cvsup-sources if missing. The location for it is /usr/local/etc now.</p>
<p>
</p>
<h2><a name="5_00__2006_09_18">5.00 - 2006.09.18</a></h2>
<dl>
<dt><strong><a name="item_code_quality">CODE QUALITY</a></strong>

<dd>
<p>* Parameter validation for nearly all subroutines using Params::Validate. Backwards compatability is now destroyed, but that should not affect anyone as all published software that uses these functions is included with the distribution. Params::Validate is included in MT distribution.</p>
</dd>
<dd>
<p>* Tests. Hundreds of new tests. In version 4, I added a plethora of tests, basically just making sure each sub and function would execute. Now most subs and functions have tests that verify inputs and results.</p>
</dd>
<dd>
<p>* Switched to Test::More for tests. Provides more and better options for writing tests, comparing results, and figuring out where the tests failed.</p>
</dd>
<dd>
<p>* Maillogs - a number of optimizations to make processing logs faster (shorter regexps, optimized ternaries to match common stuff first, removed POSIX requirement (lighten memory requirements),  updated several of the counter functions to complain about unknown errors and values, more sanity checking in functions so they give up on errors instead of blithely charging ahead.</p>
</dd>
<dd>
<p>* instead of eval's strewn all over to test for certain modules, added $perl-&gt;has_module</p>
</dd>
<dd>
<p>* all objects are created with Class-&gt;new intead of new Class.</p>
</dd>
<dd>
<p>* all errors raise exceptions by default. This requires callers to take specific action to change.</p>
</dd>
<dd>
<p>* run tests early in subroutines, reduces giant if nests and makes it easier to read the code.</p>
</dd>
</li>
<dt><strong><a name="item_misc">MISC</a></strong>

<dd>
<p>* Added Build.PL for use with Module::Build fans.</p>
</dd>
<dd>
<p>* Greatly simplified Makefile.PL by moving ``make cgi'' and ``make conf'' logic into Setup.pm. Those functions are now accessed by toaster_setup targets.</p>
</dd>
<dd>
<p>* OpenSSL config files are now updated automatically. Auto-generated certs now have the accurate information in them. Courier-IMAP certs are also updated automatically.</p>
</dd>
</li>
<dt><strong><a name="item_documentation">DOCUMENTATION</a></strong>

<dd>
<p>* Added three new test modules that test for: pod documentation for subs, pod formatting, and  automatic checking of code to test for best practices.</p>
</dd>
<dd>
<p>* moved POD documentation from being strewn about the files to the end of each file.</p>
</dd>
<dd>
<p>* wrote and re-wrote significant portions of the documentation, as well as cleaned up formatting. Documentation is now easier to find as well.</p>
</dd>
<dd>
<pre>
 changed all tnpi.biz urls to tnpi.net
 shortened most tnpi.net urls to mail-toaster.org
 updated copyright notices to 2006
 moved usage() subs into pod docs and use pod2usage</pre>
</dd>
</li>
<dt><strong><a name="item_code_formatting__26_readability">CODE FORMATTING &amp; READABILITY</a></strong>

<dd>
<p>* Used perltidy to format most of the source code.</p>
</dd>
<dd>
<p>* Used perlcritic to identify and correct (almost) all instances where my code was not using best practices, as identified in Perl Best Practices.</p>
</dd>
<dd>
<p>* All subroutines now take named arguments, making it easier to read the code and understand what is being sent and returned.</p>
</dd>
<dd>
<p>* added ``use English'' pragma and replaced all the arcane $^ and $[ perl variables with their english name equivalents.</p>
</dd>
</li>
<dt><strong><a name="item_web_interface_2fcgi">WEB INTERFACE/CGI</a></strong>

<dd>
<p>* Completely new webmail/logon interface. Written entirely in HTML, CSS, and JavaScript.</p>
</dd>
<dd>
<p>* The format of toaster-watcher.conf is altered slightly. It is more consistent in the internal layout so that my programs can alter it reliably.</p>
</dd>
<dd>
<p>* removed httpd.conf patches in favor of installing a mail-toaster.conf file with all the requisite apache directives.</p>
</dd>
<dd>
<p>* Organized all the cgi related docs into cgi_files directory. They are now installed via the -s webmail target to toaster_setup.</p>
</dd>
</li>
</dl>
<p>See Also 4.x Changes <a href="http://mail-toaster.org/changes/4.x-changes.html">http://mail-toaster.org/changes/4.x-changes.html</a></p>

</body>

</html>
